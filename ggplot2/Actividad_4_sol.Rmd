---
title: "Actividad 4 solución"
output:
  pdf_document: default
  fig_caption: true
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy.opts = list(width.cutoff = 50), tidy = TRUE, fig.pos = 'h', out.extra = '')

```

Abra un archivo de R y responda las siguientes preguntas. En cada respuesta tiene que poner el código de R como respuesta.
Cuando terminen me mandan el archivo por correo a natalia@iesta.edu.uy

```{r}
#Nombres de los integrantes del grupo

# Ejercicio 1

#1. código de R o texto con la respuesta
#2. código de R o texto con la respuesta
#3. código de R o texto con la respuesta

```

# Ejercicio 1

Con los datos `mpg` que se encuentran disponible en `ggplot2` hacer un gráfico de barras para la variables `drv` con las siguientes características:


-  Las barras tienen que estar coloreadas por `drv`

- Incluir usando `labs` el nombre de los ejes y título informativo.

- Usá la paleta de colores  `Dark2`, mirá la ayuda de `scale_colour_brewer`  

&nbsp;

```{r, echo=FALSE}
library(ggplot2)
cap1 <- "Gráfico de barras con la cantidad de  modelos según tracción. Se puede ver que la mayoría de modelos tienen tracción delantera o 4x4."


```
```{r, fig.cap = cap1}

ggplot(data = mpg) + geom_bar(aes(x = drv, fill = drv)) +
  labs(x = "Tracción", y = "Frecuencia" , fill = "Tracción") + scale_fill_brewer(palette = "Dark2", labels = c('4' = '4x4', 'f' = 'Delantera', 'r' = 'Trasera')) +
  theme(axis.ticks.x = element_blank()) +
  scale_x_discrete(labels = c('4' = '4x4', 'f' = 'Delantera',
  'r' = 'Trasera'))
  
```

\pagebreak

# Ejercicio 2

 Usando como base el gráfico anterior, incluya:
 
 
- Incluir en el eje `y` porcentaje en vez de conteos

-  Usando `scale_y_continuous` cambiar la escala del eje `y` a porcentajes

- Usando `geom_text` incluir texto con porcentajes arriba de cada barra  

&nbsp;

```{r, echo = FALSE}
cap2 <-  "Gráfico de barras con el porcentaje de  modelos según tracción. Se puede ver que la mayoría de modelos tienen tracción delantera o 4x4. 45.3 tienen tracción delantera, 44 tracción 4x4 y 10.7 tracción trasera"
```

```{r,  fig.cap = cap2}
ggplot(data = mpg) + geom_bar(aes( x = drv, fill = drv, y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette = "Dark2", labels = c('4' = '4x4', 'f' = 'Delantera','r' = 'Trasera')) +
  geom_text(aes(x = drv, label = scales::percent((..count..) / sum(..count..)),
  y = (..count..) / sum(..count..)), stat = "count", vjust = -.5) +
   labs(x = "Tracción", y = "Frecuencia", fill = "Tracción") +   theme(axis.ticks.x = element_blank()) +
  scale_x_discrete(labels = c('4' = '4x4', 'f' = 'Delantera',
  'r' = 'Trasera')) 

```




  
